import './polyfills.server.mjs';
import{a as O,c as A,m as j}from"./chunk-U3SMCWPM.mjs";import{a as F,b as H,c as R,d as q}from"./chunk-IRLGTZDS.mjs";import{$a as _,Ia as w,L as P,La as f,Ma as x,Oa as n,Pa as o,Pb as D,Q as M,Qa as E,Qb as T,Ra as v,Rb as W,Sa as C,Sb as B,Ta as u,V as U,Xa as s,Ya as p,Za as k,_a as L,ab as h,ba as c,bb as g,ca as d,db as V,fb as I,gb as N,wa as a,xa as b}from"./chunk-Z3X67S6Q.mjs";import{a as y}from"./chunk-5XUXGTUW.mjs";var z={production:!0,apiUrl:"http://localhost:3000"};var S=class m{constructor(e){this.http=e}urls=`${z.apiUrl}/customers`;getCustomer(){return this.http.get(this.urls)}addCustomer(e){return this.http.post(this.urls,e)}deleteCustomer(e){return this.http.request("DELETE",`${this.urls}/${e}`,{body:{CUS_LastModifiedBy:1},headers:{"Content-Type":"application/json"}})}updateCustomer(e){return this.http.put(`${this.urls}/${e.CUS_CustomerID}`,e)}static \u0275fac=function(t){return new(t||m)(M(O))};static \u0275prov=P({token:m,factory:m.\u0275fac,providedIn:"root"})};function Q(m,e){if(m&1){let t=v();n(0,"tr")(1,"td"),s(2),o(),n(3,"td"),s(4),o(),n(5,"td"),s(6),o(),n(7,"td"),s(8),o(),n(9,"td"),s(10),o(),n(11,"td"),s(12),I(13,"date"),o(),n(14,"td")(15,"button",16),C("click",function(){let i=c(t).$implicit,l=u();return d(l.openEditCustomer(i))}),s(16,"Edit"),o()(),n(17,"td")(18,"button",17),C("click",function(){let i=c(t).$implicit,l=u();return d(l.deleteCustomer(i.CUS_CustomerID))}),s(19,"Delete"),o()(),n(20,"td")(21,"button",18),C("click",function(){let i=c(t).$implicit,l=u();return d(l.orderCustomer(i))}),s(22,"Order"),o()()()}if(m&2){let t=e.$implicit;a(2),p(t.CUS_CustomerID),a(2),p(t.CUS_CustomerName),a(2),p(t.CUS_PhoneNumber),a(2),p(t.CUS_Village),a(2),p(t.CUS_District),a(2),p(N(13,6,t.CUS_CreatedAt,"dd-MM-yyyy"))}}function X(m,e){m&1&&E(0,"div",19)}function Y(m,e){if(m&1){let t=v();n(0,"div",20)(1,"div",21)(2,"div",22)(3,"div",23)(4,"h5",24),s(5),o(),n(6,"button",25),C("click",function(){c(t);let i=u();return d(i.closeModal())}),o()(),n(7,"div",26)(8,"input",27),g("ngModelChange",function(i){c(t);let l=u();return h(l.newCustomer.CUS_CustomerName,i)||(l.newCustomer.CUS_CustomerName=i),d(i)}),o(),n(9,"input",28),g("ngModelChange",function(i){c(t);let l=u();return h(l.newCustomer.CUS_PhoneNumber,i)||(l.newCustomer.CUS_PhoneNumber=i),d(i)}),o(),n(10,"input",29),g("ngModelChange",function(i){c(t);let l=u();return h(l.newCustomer.CUS_Village,i)||(l.newCustomer.CUS_Village=i),d(i)}),o(),n(11,"input",30),g("ngModelChange",function(i){c(t);let l=u();return h(l.newCustomer.CUS_Block,i)||(l.newCustomer.CUS_Block=i),d(i)}),o(),n(12,"input",31),g("ngModelChange",function(i){c(t);let l=u();return h(l.newCustomer.CUS_District,i)||(l.newCustomer.CUS_District=i),d(i)}),o()(),n(13,"div",32)(14,"button",33),C("click",function(){c(t);let i=u();return d(i.closeModal())}),s(15,"Cancel"),o(),n(16,"button",34),C("click",function(){c(t);let i=u();return d(i.addCustomer())}),s(17),o()()()()()}if(m&2){let t=u();a(5),k("",t.newCustomer.CUS_CustomerID?"Edit":"Add"," Customer"),a(3),_("ngModel",t.newCustomer.CUS_CustomerName),a(),_("ngModel",t.newCustomer.CUS_PhoneNumber),a(),_("ngModel",t.newCustomer.CUS_Village),a(),_("ngModel",t.newCustomer.CUS_Block),a(),_("ngModel",t.newCustomer.CUS_District),a(5),p(t.newCustomer.CUS_CustomerID?"Update":"Add")}}var G=class m{constructor(e,t){this.customerService=e;this.router=t}customer=[];filterCustomer=[];searchPhone="";currentPage=1;itemPerPage=10;showModal=!1;newCustomer={CUS_CustomerName:"",CUS_PhoneNumber:"",CUS_Village:"",CUS_Block:"",CUS_District:"",CUS_CreatedBy:1};ngOnInit(){this.loadCustomers()}loadCustomers(){this.customerService.getCustomer().subscribe({next:e=>{this.customer=e,this.filterCustomer=e},error:e=>{console.error("Error loading customers",e)}})}onSearch(){let e=this.searchPhone.trim();e?this.filterCustomer=this.customer.filter(t=>t.CUS_PhoneNumber?.includes(e)):this.filterCustomer=[...this.customer],this.currentPage=1}get paginatedCustomers(){let e=(this.currentPage-1)*this.itemPerPage;return this.filterCustomer.slice(e,e+this.itemPerPage)}totalPages(){return Math.ceil(this.filterCustomer.length/this.itemPerPage)}changePage(e){e==="prev"&&this.currentPage>1&&this.currentPage--,e==="next"&&this.currentPage<this.totalPages()&&this.currentPage++}openAddCustomer(){this.newCustomer={CUS_CustomerName:"",CUS_PhoneNumber:"",CUS_Village:"",CUS_Block:"",CUS_District:"",CUS_CreatedBy:1},this.showModal=!0}closeModal(){this.showModal=!1}addCustomer(){this.newCustomer.CUS_CustomerID?this.customerService.updateCustomer(this.newCustomer).subscribe({next:e=>{this.loadCustomers(),this.closeModal()},error:e=>{console.error("Error Updating Customer",e)}}):this.customerService.addCustomer(this.newCustomer).subscribe({next:e=>{this.loadCustomers(),this.closeModal()},error:e=>{console.error("Error Adding Customer",e)}})}deleteCustomer(e){this.customerService.deleteCustomer(e).subscribe({next:()=>{this.loadCustomers()}})}openEditCustomer(e){this.newCustomer=y({},e),this.showModal=!0}orderCustomer(e){let t=e.CUS_CustomerID,r=e.CUS_PhoneNumber;this.router.navigate(["/dashboard/order",t,r])}static \u0275fac=function(t){return new(t||m)(b(S),b(j))};static \u0275cmp=U({type:m,selectors:[["app-customer-list"]],standalone:!0,features:[V],decls:40,vars:10,consts:[[1,"d-flex","justify-content-between","mb-3","m-top30"],["type","text","placeholder","Search by phone",1,"form-control","w-50",3,"ngModelChange","input","ngModel"],[1,"btn","btn-info","ms-3",3,"click"],[1,"container","mt-3","overscroll"],[1,"table-overflow"],[1,"table","table-striped"],["colspan","3"],[4,"ngFor","ngForOf"],[1,"mt-3"],[1,"pagination","justify-content-center"],[1,"page-item"],[1,"page-link",3,"click"],[1,"page-item","disabled"],[1,"page-link"],["class","modal-overlay",4,"ngIf"],["class","modal fade show d-block","tabindex","-1",4,"ngIf"],[1,"btn","btn-sm","btn-secondary","me-2",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"modal-overlay"],["tabindex","-1",1,"modal","fade","show","d-block"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],["placeholder","Customer Name",1,"form-control","mb-2",3,"ngModelChange","ngModel"],["placeholder","Phone Number",1,"form-control","mb-2",3,"ngModelChange","ngModel"],["placeholder","Customer Village",1,"form-control","mb-2",3,"ngModelChange","ngModel"],["placeholder","Customer Block",1,"form-control","mb-2",3,"ngModelChange","ngModel"],["placeholder","Customer District",1,"form-control","mb-2",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-success",3,"click"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"input",1),g("ngModelChange",function(l){return h(r.searchPhone,l)||(r.searchPhone=l),l}),C("input",function(){return r.onSearch()}),o(),n(2,"button",2),C("click",function(){return r.openAddCustomer()}),s(3,"Add Customer"),o()(),n(4,"div",3)(5,"h4"),s(6,"Customer List"),o(),n(7,"div",4)(8,"table",5)(9,"thead")(10,"tr")(11,"th"),s(12,"ID"),o(),n(13,"th"),s(14,"Name"),o(),n(15,"th"),s(16,"Phone"),o(),n(17,"th"),s(18,"Village"),o(),n(19,"th"),s(20,"District"),o(),n(21,"th"),s(22,"CreatedAt"),o(),n(23,"th",6),s(24,"Action"),o()()(),n(25,"tbody"),w(26,Q,23,9,"tr",7),o()()(),n(27,"nav",8)(28,"ul",9)(29,"li",10)(30,"button",11),C("click",function(){return r.changePage("prev")}),s(31,"Previous"),o()(),n(32,"li",12)(33,"span",13),s(34),o()(),n(35,"li",10)(36,"button",11),C("click",function(){return r.changePage("next")}),s(37,"Next"),o()()()()(),w(38,X,1,0,"div",14)(39,Y,18,7,"div",15)),t&2&&(a(),_("ngModel",r.searchPhone),a(25),f("ngForOf",r.paginatedCustomers),a(3),x("disabled",r.currentPage===1),a(5),L(" Page ",r.currentPage," of ",r.totalPages()," "),a(),x("disabled",r.currentPage===r.totalPages()),a(3),f("ngIf",r.showModal),a(),f("ngIf",r.showModal))},dependencies:[B,D,T,W,A,q,F,H,R],styles:["@media (max-width: 767px){.ms-3[_ngcontent-%COMP%]{margin-left:0!important;margin-top:10px}.overscroll[_ngcontent-%COMP%]{overflow:auto}}"]})};export{G as CustomerListComponent};
