import{a as O,b as A,f as j,k as F}from"./chunk-SGCU524L.js";import{a as H,b as R,c as q,d as z}from"./chunk-QHUXSXGZ.js";import{$a as h,Cb as D,Db as T,Eb as W,Fb as B,Ha as w,Ka as f,La as x,Na as n,O as P,Oa as r,Pa as E,Qa as v,Ra as C,Sa as u,T as M,Wa as s,Xa as p,Y as U,Ya as k,Za as L,_a as _,a as y,ab as g,cb as V,eb as I,fa as c,fb as N,ga as d,wa as a,xa as b}from"./chunk-AFNXOWCL.js";var S=class m{constructor(e){this.http=e}urls=`${F.apiUrl}/customers`;getCustomer(){return this.http.get(this.urls)}addCustomer(e){return this.http.post(this.urls,e)}deleteCustomer(e){return this.http.request("DELETE",`${this.urls}/${e}`,{body:{CUS_LastModifiedBy:1},headers:{"Content-Type":"application/json"}})}updateCustomer(e){return this.http.put(`${this.urls}/${e.CUS_CustomerID}`,e)}static \u0275fac=function(t){return new(t||m)(M(O))};static \u0275prov=P({token:m,factory:m.\u0275fac,providedIn:"root"})};function Q(m,e){if(m&1){let t=v();n(0,"tr")(1,"td"),s(2),r(),n(3,"td"),s(4),r(),n(5,"td"),s(6),r(),n(7,"td"),s(8),r(),n(9,"td"),s(10),r(),n(11,"td"),s(12),I(13,"date"),r(),n(14,"td")(15,"button",16),C("click",function(){let i=c(t).$implicit,l=u();return d(l.openEditCustomer(i))}),s(16,"Edit"),r()(),n(17,"td")(18,"button",17),C("click",function(){let i=c(t).$implicit,l=u();return d(l.deleteCustomer(i.CUS_CustomerID))}),s(19,"Delete"),r()(),n(20,"td")(21,"button",18),C("click",function(){let i=c(t).$implicit,l=u();return d(l.orderCustomer(i))}),s(22,"Order"),r()()()}if(m&2){let t=e.$implicit;a(2),p(t.CUS_CustomerID),a(2),p(t.CUS_CustomerName),a(2),p(t.CUS_PhoneNumber),a(2),p(t.CUS_Village),a(2),p(t.CUS_District),a(2),p(N(13,6,t.CUS_CreatedAt,"dd-MM-yyyy"))}}function X(m,e){m&1&&E(0,"div",19)}function Y(m,e){if(m&1){let t=v();n(0,"div",20)(1,"div",21)(2,"div",22)(3,"div",23)(4,"h5",24),s(5),r(),n(6,"button",25),C("click",function(){c(t);let i=u();return d(i.closeModal())}),r()(),n(7,"div",26)(8,"input",27),g("ngModelChange",function(i){c(t);let l=u();return h(l.newCustomer.CUS_CustomerName,i)||(l.newCustomer.CUS_CustomerName=i),d(i)}),r(),n(9,"input",28),g("ngModelChange",function(i){c(t);let l=u();return h(l.newCustomer.CUS_PhoneNumber,i)||(l.newCustomer.CUS_PhoneNumber=i),d(i)}),r(),n(10,"input",29),g("ngModelChange",function(i){c(t);let l=u();return h(l.newCustomer.CUS_Village,i)||(l.newCustomer.CUS_Village=i),d(i)}),r(),n(11,"input",30),g("ngModelChange",function(i){c(t);let l=u();return h(l.newCustomer.CUS_Block,i)||(l.newCustomer.CUS_Block=i),d(i)}),r(),n(12,"input",31),g("ngModelChange",function(i){c(t);let l=u();return h(l.newCustomer.CUS_District,i)||(l.newCustomer.CUS_District=i),d(i)}),r()(),n(13,"div",32)(14,"button",33),C("click",function(){c(t);let i=u();return d(i.closeModal())}),s(15,"Cancel"),r(),n(16,"button",34),C("click",function(){c(t);let i=u();return d(i.addCustomer())}),s(17),r()()()()()}if(m&2){let t=u();a(5),k("",t.newCustomer.CUS_CustomerID?"Edit":"Add"," Customer"),a(3),_("ngModel",t.newCustomer.CUS_CustomerName),a(),_("ngModel",t.newCustomer.CUS_PhoneNumber),a(),_("ngModel",t.newCustomer.CUS_Village),a(),_("ngModel",t.newCustomer.CUS_Block),a(),_("ngModel",t.newCustomer.CUS_District),a(5),p(t.newCustomer.CUS_CustomerID?"Update":"Add")}}var G=class m{constructor(e,t){this.customerService=e;this.router=t}customer=[];filterCustomer=[];searchPhone="";currentPage=1;itemPerPage=10;showModal=!1;newCustomer={CUS_CustomerName:"",CUS_PhoneNumber:"",CUS_Village:"",CUS_Block:"",CUS_District:"",CUS_CreatedBy:1};ngOnInit(){this.loadCustomers()}loadCustomers(){this.customerService.getCustomer().subscribe({next:e=>{this.customer=e,this.filterCustomer=e},error:e=>{console.error("Error loading customers",e)}})}onSearch(){let e=this.searchPhone.trim();e?this.filterCustomer=this.customer.filter(t=>t.CUS_PhoneNumber?.includes(e)):this.filterCustomer=[...this.customer],this.currentPage=1}get paginatedCustomers(){let e=(this.currentPage-1)*this.itemPerPage;return this.filterCustomer.slice(e,e+this.itemPerPage)}totalPages(){return Math.ceil(this.filterCustomer.length/this.itemPerPage)}changePage(e){e==="prev"&&this.currentPage>1&&this.currentPage--,e==="next"&&this.currentPage<this.totalPages()&&this.currentPage++}openAddCustomer(){this.newCustomer={CUS_CustomerName:"",CUS_PhoneNumber:"",CUS_Village:"",CUS_Block:"",CUS_District:"",CUS_CreatedBy:1},this.showModal=!0}closeModal(){this.showModal=!1}addCustomer(){this.newCustomer.CUS_CustomerID?this.customerService.updateCustomer(this.newCustomer).subscribe({next:e=>{this.loadCustomers(),this.closeModal()},error:e=>{console.error("Error Updating Customer",e)}}):this.customerService.addCustomer(this.newCustomer).subscribe({next:e=>{this.loadCustomers(),this.closeModal()},error:e=>{console.error("Error Adding Customer",e)}})}deleteCustomer(e){this.customerService.deleteCustomer(e).subscribe({next:()=>{this.loadCustomers()}})}openEditCustomer(e){this.newCustomer=y({},e),this.showModal=!0}orderCustomer(e){let t=e.CUS_CustomerID,o=e.CUS_PhoneNumber;this.router.navigate(["/dashboard/order",t,o])}static \u0275fac=function(t){return new(t||m)(b(S),b(j))};static \u0275cmp=U({type:m,selectors:[["app-customer-list"]],standalone:!0,features:[V],decls:40,vars:10,consts:[[1,"d-flex","justify-content-between","mb-3","m-top30"],["type","text","placeholder","Search by phone",1,"form-control","w-50",3,"ngModelChange","input","ngModel"],[1,"btn","btn-info","ms-3",3,"click"],[1,"container","mt-3","overscroll"],[1,"table-overflow"],[1,"table","table-striped"],["colspan","3"],[4,"ngFor","ngForOf"],[1,"mt-3"],[1,"pagination","justify-content-center"],[1,"page-item"],[1,"page-link",3,"click"],[1,"page-item","disabled"],[1,"page-link"],["class","modal-overlay",4,"ngIf"],["class","modal fade show d-block","tabindex","-1",4,"ngIf"],[1,"btn","btn-sm","btn-secondary","me-2",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"modal-overlay"],["tabindex","-1",1,"modal","fade","show","d-block"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],["placeholder","Customer Name",1,"form-control","mb-2",3,"ngModelChange","ngModel"],["placeholder","Phone Number",1,"form-control","mb-2",3,"ngModelChange","ngModel"],["placeholder","Customer Village",1,"form-control","mb-2",3,"ngModelChange","ngModel"],["placeholder","Customer Block",1,"form-control","mb-2",3,"ngModelChange","ngModel"],["placeholder","Customer District",1,"form-control","mb-2",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-success",3,"click"]],template:function(t,o){t&1&&(n(0,"div",0)(1,"input",1),g("ngModelChange",function(l){return h(o.searchPhone,l)||(o.searchPhone=l),l}),C("input",function(){return o.onSearch()}),r(),n(2,"button",2),C("click",function(){return o.openAddCustomer()}),s(3,"Add Customer"),r()(),n(4,"div",3)(5,"h4"),s(6,"Customer List"),r(),n(7,"div",4)(8,"table",5)(9,"thead")(10,"tr")(11,"th"),s(12,"ID"),r(),n(13,"th"),s(14,"Name"),r(),n(15,"th"),s(16,"Phone"),r(),n(17,"th"),s(18,"Village"),r(),n(19,"th"),s(20,"District"),r(),n(21,"th"),s(22,"CreatedAt"),r(),n(23,"th",6),s(24,"Action"),r()()(),n(25,"tbody"),w(26,Q,23,9,"tr",7),r()()(),n(27,"nav",8)(28,"ul",9)(29,"li",10)(30,"button",11),C("click",function(){return o.changePage("prev")}),s(31,"Previous"),r()(),n(32,"li",12)(33,"span",13),s(34),r()(),n(35,"li",10)(36,"button",11),C("click",function(){return o.changePage("next")}),s(37,"Next"),r()()()()(),w(38,X,1,0,"div",14)(39,Y,18,7,"div",15)),t&2&&(a(),_("ngModel",o.searchPhone),a(25),f("ngForOf",o.paginatedCustomers),a(3),x("disabled",o.currentPage===1),a(5),L(" Page ",o.currentPage," of ",o.totalPages()," "),a(),x("disabled",o.currentPage===o.totalPages()),a(3),f("ngIf",o.showModal),a(),f("ngIf",o.showModal))},dependencies:[B,D,T,W,A,z,H,R,q],styles:["@media (max-width: 767px){.ms-3[_ngcontent-%COMP%]{margin-left:0!important;margin-top:10px}.overscroll[_ngcontent-%COMP%]{overflow:auto}}"]})};export{G as CustomerListComponent};
